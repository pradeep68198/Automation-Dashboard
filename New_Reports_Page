package com.JE.Pages;

import java.io.File;

import org.openqa.selenium.By;
import org.openqa.selenium.Keys;

import com.JE.Utilities.General_Wrapper;

public class New_Reports_Page extends General_Wrapper{

    public By Request_dropdown=By.xpath("//label[text()='Request']/following-sibling::div/angular2-multiselect/div/div[1]/div");
    public By Request_search=By.xpath("//label[text()='Request']/following-sibling::div/angular2-multiselect/div/div[2]/div[3]/div/input");
    public By Request_select=By.xpath("//label[text()='Request']/following-sibling::div/angular2-multiselect/div/div[2]/div[3]/ul/span/li[1]");
    
    public By Manager_dropdown=By.xpath("//label[text()='Manager ID']/following-sibling::div/angular2-multiselect/div/div[1]/div");
    public By Manager_search=By.xpath("//label[text()='Manager ID']/following-sibling::div/angular2-multiselect/div/div[2]/div[3]/div/input");
    public By Manager_select=By.xpath("//label[text()='Manager ID']/following-sibling::div/angular2-multiselect/div/div[2]/div[3]/ul/span/li[1]");
    public By Manager_select1=By.xpath("//label[text()='Manager ID']/following-sibling::div/angular2-multiselect/div/div[2]/div[3]/ul/span/li[2]");
   
    public By Continue_Button=By.xpath("//button[text()='Continue']");
    
    public By Start_Date=By.xpath("//label[text()='Start Date']/following-sibling::div/input");
    public By End_Date=By.xpath("//label[text()='End Date']/following-sibling::div/input");
  
    public By Search_Button=By.xpath("//button[text()='Search']");
    public By Download=By.xpath("//a[text()='Download to Excel']");
    public By wait=By.xpath("//*[@id='tableid']/tbody/tr/td[3]");
    
    public By SOC_Direct=By.xpath("//label[text()=' Direct reportees']");
    public By SOC_include=By.xpath("//label[text()=' Include Span of control']");
    
    
   
   
    public void Start_Date_Action(String value){
   	
   	enterText(Start_Date,value,"Start_Date");
   	
   }
    
    public void End_Date_Action(String value){
       	
    	 Click(End_Date,"End_Date");
       	enterText(End_Date,value,"End_Date");
       	Click(Start_Date,"Start_Date");
       	
       }
    
    public void SOC_Action(String value){
       	
   	 if(value.contains("Direct reportees")) {
    	Click(SOC_Direct,"SOC_Direct");
      	
   	 }
   	 else {
   		Click(SOC_include,"SOC_include");
   	 }
      	
      }
    
    
    public void Request_Action(String value){
    	Click(Request_dropdown,"Request_dropdown");
       	
       	enterText(Request_search,value,"Request_search");
       	Click(Request_select,"Request_select");
       	
       }
    
    
    public void ManagerAction(String value) throws InterruptedException{
    	Click(Manager_dropdown,"Manager_dropdown");
       	
       	enterText(Manager_search,value,"Manager_search");
       	
       	for(int i=0;i<=10;i++) {
	    	driver.findElement(Manager_search).sendKeys(Keys.ENTER);
	    	Thread.sleep(2000);
	    	if(!(isElementPresent(Manager_select1))) {
	    		break;
	    	
	    	}
	    	Thread.sleep(2000);
	    	}
	    	
       	Click(Manager_select,"Manager_select");
       	
       }
    
    
    
  
  
    
    public  void Search_Button_Action(){
		
      	 Click(Search_Button,"Search_Button");
      	
      }
    
    
    public  void Continue_Button_Action(){
		
      	 Click(Continue_Button,"Continue_Button");
      	
      }
    
    public  String Download_Action(String file_name) throws InterruptedException{
    	
    	 String val="";
        waitForElement(wait,"wait for search result");
		
      	 Click(Download,"Download");
      	 Thread.sleep(15000);
      	 
      	String name="";
     	  File folder = new File(Download_Path);
       File[] listOfFiles = folder.listFiles();
         
                  for(int i=0;i<listOfFiles.length;i++) {	 
                   name=listOfFiles[i].getName();
  	              
                if(name.contains(file_name)) {
  	    	  val=Download_Path+name;
  	    	  System.out.println(val); 
  	    	  break;
                }
                
  	    	  
                  }
      	 
      	 
      	  return val;
      	
      }
    

}
