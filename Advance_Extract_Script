package com.JE.Sprint1;

import java.awt.AWTException;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.sql.SQLException;
import java.text.ParseException;

import com.JE.Func_Script.Mark_Logic;
import com.JE.Utilities.Base_Class;
import com.JE.Utilities.File_Compare;
import com.jcraft.jsch.JSchException;
import com.jcraft.jsch.SftpException;

public class Advance_Extract_Script extends Base_Class{
	
	String manager_url;
	
	
	public Advance_Extract_Script() throws FileNotFoundException, IOException
	{
		super();
	}
	
	public void Report_launch(String Manger_ID,String Start_Date,String End_Date,String Index) throws ClassNotFoundException, InterruptedException, AWTException, SQLException, JSchException, SftpException, IOException, ParseException {
		
		
		String[] Values=Find_Query(Index);
		String SD=Date_converter(Start_Date);
		String LSD=Date_converter(End_Date);
		String query= String.format(Values[1], SD,LSD);
		String Primary=Values[2];
		String result_file=Report_Path+"Data_Compare.xlsx";
		String Unixquerypath=Values[3];
	
		new Mark_Logic().ML_Launcher(Values[0],query,Unixquerypath);
		
		
		manager_url=New_Report+Manger_ID;
		driver.get(manager_url);
		report.Request_Action("Advance Extract with Demographics");
		report.Continue_Button_Action();
		report.Start_Date_Action(Start_Date);
		report.End_Date_Action(End_Date);
		report.Search_Button_Action();
		String Excel_Path=report.Download_Action("Advance_Extract_with_Demographics");
		
		
		new File_Compare().Common_caller(Primary,result_file, Download_Path+"Query_Data.txt", Excel_Path);
		
		
	}
	
	
	
	public String[] Find_Query(String index) throws IOException {
		
		String[][] data=readXLSX(ML_Query,"Advance_Extract");
		
		
	     String[] val = new String[4];
	    
		
		for(int i=1;i<data[0].length;i++){
		
		 if(data[0][i].equalsIgnoreCase(index)){
			  
			
			 val[0]=data[1][i];
			 val[1]=data[2][i];
			 val[2]=data[3][i];
			 val[3]=data[4][i];
				 break;
				 	 
		 }	 
		 
		}
		
		
		
		return val;
		
		
		
		
	}


	

}
